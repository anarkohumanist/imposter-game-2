<!DOCTYPE html>
<html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Kim Ä°mpostor?</title>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
<script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script src="https://cdn.tailwindcss.com"></script>
<style>
*{-webkit-tap-highlight-color:transparent}
body{margin:0;padding:0;overflow:hidden;position:fixed;width:100%;height:100%}
#root{width:100%;height:100%;overflow-y:auto}
input,button,select{font-size:16px!important}
.pulse{animation:pulse 2s cubic-bezier(0.4,0,0.6,1) infinite}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}
.ticker-wrap{overflow:hidden;background:rgba(0,0,0,0.5);border-top:1px solid rgba(255,255,255,0.1);border-bottom:1px solid rgba(255,255,255,0.1);padding:8px 0;position:sticky;top:0;z-index:100}
.ticker{display:flex;white-space:nowrap;animation:ticker 28s linear infinite}
@keyframes ticker{0%{transform:translateX(100vw)}100%{transform:translateX(-100%)}}
.ticker span{color:rgba(255,255,255,0.85);font-size:13px;padding:0 40px}
.ticker span b{color:rgb(253,224,71)}
</style>
</head><body><div id="root"></div>
<script type="text/babel">
const{useState,useEffect,useRef}=React;
const firebaseConfig={
    apiKey:"AIzaSyDiuOvT3TECVgnKpYSdcEadtcj0eirVLR4",
    authDomain:"imposter-iyzc-is.firebaseapp.com",
    databaseURL:"https://imposter-iyzc-is-default-rtdb.firebaseio.com",
    projectId:"imposter-iyzc-is",
    storageBucket:"imposter-iyzc-is.firebasestorage.app",
    messagingSenderId:"434645266924",
    appId:"1:434645266924:web:6e0f6fd9d49546cdf050c9"
};
let database;
try{
    if(!firebase.apps.length)firebase.initializeApp(firebaseConfig);
    database=firebase.database();
}catch(e){console.error(e)}

const CAT={
    karisik:{name:"ğŸ² KarÄ±ÅŸÄ±k",words:["Inception","Kurtlar Vadisi","Ezel","Ã‡ukur","AÅŸk-Ä± Memnu","Mustafa Kemal AtatÃ¼rk","Recep Tayyip ErdoÄŸan","Kemal KÄ±lÄ±Ã§daroÄŸlu","Devlet BahÃ§eli","Meral AkÅŸener","Turgut Ã–zal","SÃ¼leyman Demirel","BÃ¼lent Ecevit","Adnan Menderes","Necmettin Erbakan","Selahattin DemirtaÅŸâ€,â€Fetullah GÃ¼lenâ€,â€APOâ€,"Yaprak DÃ¶kÃ¼mÃ¼","Avrupa YakasÄ±","Leyla ile Mecnun","KardeÅŸ PayÄ±","Cennet Mahallesi","Akasya DuraÄŸÄ±","Titanik","Avatar","Harry Potter","Star Wars","Matrix","Breaking Bad","Friends","Squid Game","Wednesday","The Last of Us","Dark","Peaky Blinders","Amerika","Ä°ngiltere","Fransa","Almanya","Ä°talya","Japonya","Brezilya","Avustralya","Kanada","Ä°spanya","Ã‡in","Lamborghini","Porsche","Mercedes","BMW","Audi","Tesla","Toyota","Ford","Bugatti","Rolls Royce","McLaren","Sanal Pos","retry","3D Secure","Pricing","elazig"]},
    music:{name:"ğŸµ MÃ¼zik",words:["Tarkan","Sezen Aksu","Beyonce","Taylor Swift","Ed Sheeran","Adele","Drake","Queen","Beatles","Coldplay","Billie Eilish","Rihanna","Eminem"]},
    sports:{name:"âš½ Spor",words:["Messi","Ronaldo","Neymar","Mbappe","Haaland","Galatasaray","FenerbahÃ§e","BeÅŸiktaÅŸ","Barcelona","Real Madrid","Liverpool","Bayern Munich"]},
    games:{name:"ğŸ® Oyunlar",words:["Uzun EÅŸek","Masa Tenisi"]},
    food:{name:"ğŸ” Yemek",words:["Pizza","Burger","Kebap","Sushi","Adana Kebap","Urfa Kebap","Ä°skender","Lahmacun","Pide","MantÄ±","KarnÄ±yarÄ±k","Ä°mam BayÄ±ldÄ±","Dolma","Sarma","Kuru Fasulye","Pilav","Menemen","Sucuklu Yumurta","KokoreÃ§","Midye Dolma","BalÄ±k Ekmek","Ã‡iÄŸ KÃ¶fte","Mercimek Ã‡orbasÄ±","Ezogelin Ã‡orbasÄ±","Tarhana","BÃ¶rek","GÃ¶zleme","Simit","Kumpir","Baklava","KÃ¼nefe","KadayÄ±f","Lokum","SÃ¼tlaÃ§","Kazandibi","Revani","AÅŸure","Åalgam","Ayran","Pasta","Baklava","DÃ¶ner","MantÄ±","BÃ¶rek","Lahmacun","KÃ¼nefe","Ramen"]},
    animals:{name:"ğŸ¾ Hayvanlar",words:["Aslan","Kaplan","Fil","ZÃ¼rafa","KÃ¶pek","Kedi","Yunus","Balina","Panda","Koala","Kanguru","Kurt"]},
    tech:{name:"ğŸ“± Teknoloji",words:["Apple","Samsung","Google","Microsoft","iPhone","PlayStation","Xbox","Netflix","Spotify","Tesla","TikTok","Instagram"]},
    celebrities:{name:"ğŸ­ ÃœnlÃ¼ler",words:["Tarkan","Åevko","Laz Ziya","HÃ¼srev AÄŸa","Memati BaÅŸ","CerrahpaÅŸalÄ± Halit","Ezel Bayraktar","Ã–mer UÃ§ar","Cengiz Atay","Tefoâ€,â€Cennet Mahallesi Yunusâ€,â€Cennet Mahallesi Beter Aliâ€,â€Akasya DuraÄŸÄ± Usman Agaâ€,"HÃ¼seyin Ã‡avuÅŸoÄŸlu","Kadir BÃ¼yÃ¼kbay","Utku UlaÅŸ Topac","Ã‡aÄŸdaÅŸ AteÅŸ"]}
};

const SCORE_RULES=[
    {text:"Tek baÅŸÄ±na impostoru bulan",pts:"+5"},
    {text:"Ä°mpostoru birden fazla bulan",pts:"+2"},
    {text:"Ä°mpostor yakalanmazsa",pts:"+5"},
    {text:"Ä°mpostor yakalanÄ±rsa",pts:"-1"},
    {text:"YanlÄ±ÅŸ tahmin eden",pts:"-2"},
];

function ScoreTicker(){
    const items=[...SCORE_RULES,...SCORE_RULES];
    return(
        <div className="ticker-wrap">
            <div className="ticker">
                {items.map((r,i)=>(
                    <span key={i}>ğŸ¯ {r.text}: <b>{r.pts} puan</b></span>
                ))}
            </div>
        </div>
    );
}

function App(){
    const[s,setS]=useState('menu');
    const[pn,setPn]=useState('');
    const[rc,setRc]=useState('');
    const[irc,setIrc]=useState('');
    const[in1,setIn]=useState('');
    const[rm,setRm]=useState(null);
    const[ih,setIh]=useState(false);
    const[sc,setSc]=useState(null);
    const[mr,setMr]=useState(null);
    const[selectedImpostors,setSelectedImpostors]=useState([]); // TÄ±klayarak seÃ§ilen impostorlar
    const[hg,setHg]=useState(false);
    const[loading,setLoading]=useState(false);
    const[impCount,setImpCount]=useState(1);
    const[displayOrder,setDisplayOrder]=useState([]);
    const rr=useRef(null);
    const pnRef=useRef(pn);
    const ihRef=useRef(ih);
    const rcRef=useRef(rc);
    useEffect(()=>{pnRef.current=pn},[pn]);
    useEffect(()=>{ihRef.current=ih},[ih]);
    useEffect(()=>{rcRef.current=rc},[rc]);

    useEffect(()=>{
        if(!rc||!database)return;
        rr.current=database.ref(`rooms/${rc}`);
        const l=rr.current.on('value',snap=>{
            const d=snap.val();
            if(!d)return;
            setRm(d);
            if(d.gameState==='playing'){
                const mp=d.players?.find(p=>p.name===pnRef.current);
                if(mp){
                    setMr(mp.role);
                    setS(prev=>{
                        if(prev!=='game'){
                            const shuffled=[...(d.players||[])].sort(()=>Math.random()-0.5);
                            setDisplayOrder(shuffled.map(p=>p.name));
                            return 'game';
                        }
                        return prev;
                    });
                }
                if(ihRef.current){
                    const cms=d.players?.filter(p=>p.role==='crewmate')||[];
                    const allVoted=cms.length>0&&cms.every(p=>p.guess!==null&&p.guess!==undefined);
                    if(allVoted&&d.gameState==='playing'){
                        calcResults(d,rcRef.current);
                    }
                }
            }
            if(d.gameState==='results'){
                setS('results');
            }
            if(d.gameState==='lobby'){
                setS(prev=>{
                    if(prev==='results'||prev==='game'){
                        setMr(null);setHg(false);setSelectedImpostors([]);setSc(null);setDisplayOrder([]);
                        return 'lobby';
                    }
                    return prev;
                });
            }
        });
        return()=>{if(rr.current)rr.current.off('value',l)}
    },[rc]);

    const calcResults=async(currentRoom, roomCode)=>{
        if(currentRoom.gameState==='results')return;
        const impostors=currentRoom.players.filter(p=>p.role==='impostor');
        const cms=currentRoom.players.filter(p=>p.role==='crewmate');
        const up=[...currentRoom.players];
        const correctGuessers=[];
        const wrongGuessers=[];
        cms.forEach(pl=>{
            const guessLower=pl.guess?.toLowerCase()||'';
            const hitImp=impostors.find(imp=>imp.name.toLowerCase()===guessLower);
            if(hitImp){
                correctGuessers.push(pl.name);
            } else {
                wrongGuessers.push(pl.name);
            }
        });
        const solo=(correctGuessers.length===1);
        up.forEach((p,i)=>{
            if(p.role==='crewmate'){
                if(correctGuessers.includes(p.name)){
                    up[i]={...p,points:p.points+(solo?5:2)};
                } else {
                    up[i]={...p,points:p.points-2};
                }
            }
            if(p.role==='impostor'){
                if(correctGuessers.length===0){
                    up[i]={...p,points:p.points+5};
                } else {
                    up[i]={...p,points:p.points-1};
                }
            }
        });
        const winner=correctGuessers.length>0?'crewmate':'impostor';
        try{
            await database.ref(`rooms/${roomCode}`).update({
                players:up,correctGuessers,wrongGuessers,winner,gameState:'results'
            });
        }catch(e){console.error(e)}
    };

    // 3 haneli oda kodu
    const generateRoomCode=()=>{
        return String(Math.floor(100+Math.random()*900));
    };

    const cr=async()=>{
        if(!in1.trim()||!database)return;
        setLoading(true);
        const c=generateRoomCode();
        try{
            await database.ref(`rooms/${c}`).set({
                code:c,host:in1,
                players:[{name:in1,points:0,role:null,guess:null}],
                gameState:'lobby',currentRound:0,impCount:1
            });
            setRc(c);setPn(in1);setIh(true);setS('lobby');
        }catch(e){alert("Hata!")}
        setLoading(false);
    };

    const jr=async()=>{
        if(!in1.trim()||!irc.trim()||!database)return;
        setLoading(true);
        const c=irc;
        try{
            const rs=await database.ref(`rooms/${c}`).once('value');
            const er=rs.val();
            if(!er){alert("Oda bulunamadÄ±!");setLoading(false);return}
            if(er.players.some(p=>p.name===in1)){alert("Bu isim kullanÄ±lÄ±yor!");setLoading(false);return}
            er.players.push({name:in1,points:0,role:null,guess:null});
            await database.ref(`rooms/${c}`).set(er);
            setRc(c);setPn(in1);setS('lobby');
        }catch(e){alert("Hata!")}
        setLoading(false);
    };

    const kickPlayer=async(playerName)=>{
        if(!ih||!database||!rc)return;
        const updated=rm.players.filter(p=>p.name!==playerName);
        await database.ref(`rooms/${rc}/players`).set(updated);
    };

    const updateImpCount=async(count)=>{
        setImpCount(count);
        setSelectedImpostors([]); // Reset seÃ§imi
        if(database&&rc)await database.ref(`rooms/${rc}/impCount`).set(count);
    };

    // Ä°mpostoru listeden tÄ±klayarak seÃ§/kaldÄ±r
    const toggleImpostor=(playerName)=>{
        const currentImpCount=rm?.impCount||impCount;
        if(selectedImpostors.includes(playerName)){
            setSelectedImpostors(selectedImpostors.filter(n=>n!==playerName));
        } else {
            if(selectedImpostors.length<currentImpCount){
                setSelectedImpostors([...selectedImpostors,playerName]);
            }
        }
    };

    const sg=async()=>{
        if(!sc||!rm||!ih)return;
        const currentImpCount=rm?.impCount||impCount;
        
        // SeÃ§ilen impostor sayÄ±sÄ± doÄŸru mu?
        if(selectedImpostors.length!==currentImpCount){
            alert(`LÃ¼tfen ${currentImpCount} impostor seÃ§in!`);
            return;
        }

        // Manuel seÃ§ilen impostorlarÄ± ata
        const sh=[...rm.players];
        sh.forEach(p=>{
            p.role=selectedImpostors.includes(p.name)?'impostor':'crewmate';
            p.guess=null;
        });

        const w=CAT[sc].words[Math.floor(Math.random()*CAT[sc].words.length)];
        await database.ref(`rooms/${rc}`).set({
            ...rm,players:sh,gameState:'playing',
            category:sc,selectedWord:w,winner:null,
            correctGuessers:null,wrongGuessers:null
        });
    };

    const sub=async()=>{
        if(!selectedImpostors[0]||hg||!database)return;
        const idx=rm.players.findIndex(p=>p.name===pn);
        if(idx===-1||rm.players[idx].role==='impostor')return;
        await database.ref(`rooms/${rc}/players/${idx}/guess`).set(selectedImpostors[0]);
        setHg(true);
    };

    const nr=async()=>{
        if(!ih||!database)return;
        const up=rm.players.map(p=>({...p,role:null,guess:null}));
        await database.ref(`rooms/${rc}`).update({
            gameState:'lobby',players:up,
            category:null,selectedWord:null,
            winner:null,correctGuessers:null,wrongGuessers:null
        });
        setSelectedImpostors([]);
    };

    const st={
        page:{minHeight:'100vh',background:'linear-gradient(135deg,#0f0f0f,#1a1a1a,#000)',overflowY:'auto'},
        inner:{padding:'20px'},
        card:{background:'rgba(255,255,255,0.05)',backdropFilter:'blur(10px)',borderRadius:'20px',padding:'25px',border:'1px solid rgba(255,255,255,0.08)'},
        input:{width:'100%',padding:'15px',borderRadius:'10px',background:'rgba(255,255,255,0.08)',color:'white',border:'1px solid rgba(255,255,255,0.15)',outline:'none',fontSize:'16px',boxSizing:'border-box'},
        btn:(bg,dis)=>({width:'100%',background:dis?'rgba(60,60,60,0.5)':bg,color:'white',fontWeight:'bold',padding:'15px',borderRadius:'10px',border:'none',cursor:dis?'not-allowed':'pointer',fontSize:'16px',opacity:dis?.5:1}),
        label:{color:'rgba(255,255,255,0.5)',fontSize:'13px',marginBottom:'6px'},
        white:{color:'white',fontWeight:'600'},
        yellow:{color:'rgb(253,224,71)',fontWeight:'bold'}
    };

    const ScorePanel=()=>(
        <div style={{background:'rgba(0,0,0,0.4)',borderRadius:'12px',padding:'12px',marginBottom:'15px',border:'1px solid rgba(255,255,255,0.08)'}}>
            <p style={{color:'rgb(253,224,71)',fontWeight:'bold',fontSize:'13px',margin:'0 0 8px 0'}}>ğŸ“Š Puan Tablosu</p>
            {SCORE_RULES.map((r,i)=>(
                <div key={i} style={{display:'flex',justifyContent:'space-between',marginBottom:'3px'}}>
                    <span style={{color:'rgba(255,255,255,0.6)',fontSize:'12px'}}>{r.text}</span>
                    <span style={{color:r.pts.startsWith('+')?'rgb(74,222,128)':'rgb(239,68,68)',fontWeight:'bold',fontSize:'12px'}}>{r.pts}</span>
                </div>
            ))}
        </div>
    );

    if(s==='menu'){return(
        <div style={st.page}>
            <ScoreTicker/>
            <div style={{...st.inner,display:'flex',alignItems:'center',justifyContent:'center',minHeight:'calc(100vh - 37px)'}}>
                <div style={{...st.card,maxWidth:'400px',width:'100%'}}>
                    <h1 style={{fontSize:'40px',fontWeight:'bold',color:'white',textAlign:'center',margin:'0 0 8px 0'}}>ğŸ­ Kim Ä°mpostor?</h1>
                    <p style={{color:'rgba(255,255,255,0.4)',textAlign:'center',margin:'0 0 20px 0',fontSize:'13px'}}>Ã‡ok oyunculu gizem oyunu</p>
                    <ScorePanel/>
                    {!database&&<div style={{background:'rgba(239,68,68,0.2)',border:'2px solid red',borderRadius:'10px',padding:'12px',marginBottom:'15px'}}><p style={{color:'#fca5a5',margin:0,fontSize:'13px'}}>âš ï¸ Firebase baÄŸlantÄ±sÄ± yok!</p></div>}
                    <div style={{display:'flex',flexDirection:'column',gap:'12px'}}>
                        <input type="text" placeholder="Ä°sminizi Girin" value={in1} onChange={e=>setIn(e.target.value)} onKeyDown={e=>e.key==='Enter'&&cr()} style={st.input} maxLength={20}/>
                        <button onClick={cr} disabled={!in1.trim()||!database||loading} style={st.btn('linear-gradient(90deg,rgb(220,38,38),rgb(185,28,28))',!in1.trim()||!database||loading)}>
                            {loading?'BaÄŸlanÄ±yor...':'ğŸ  Oda OluÅŸtur'}
                        </button>
                        <div style={{display:'flex',alignItems:'center',gap:'10px'}}>
                            <div style={{flex:1,borderTop:'1px solid rgba(255,255,255,0.15)'}}></div>
                            <span style={{color:'rgba(255,255,255,0.4)',fontSize:'13px'}}>VEYA</span>
                            <div style={{flex:1,borderTop:'1px solid rgba(255,255,255,0.15)'}}></div>
                        </div>
                        <input type="text" placeholder="Oda Kodu (3 haneli)" value={irc} onChange={e=>setIrc(e.target.value)} style={st.input} maxLength={3}/>
                        <button onClick={jr} disabled={!in1.trim()||!irc.trim()||!database||loading} style={st.btn('linear-gradient(90deg,rgb(37,99,235),rgb(29,78,216))',!in1.trim()||!irc.trim()||!database||loading)}>
                            {loading?'BaÄŸlanÄ±yor...':'ğŸšª Odaya KatÄ±l'}
                        </button>
                    </div>
                </div>
            </div>
        </div>
    )}

    if(s==='lobby'){
        const currentImpCount=rm?.impCount||1;
        return(
            <div style={st.page}>
                <ScoreTicker/>
                <div style={st.inner}>
                    <div style={{maxWidth:'600px',margin:'0 auto'}}>
                        <div style={{...st.card,textAlign:'center',marginBottom:'15px'}}>
                            <p style={st.label}>Oda Kodu - ArkadaÅŸlarÄ±nÄ±zla paylaÅŸÄ±n</p>
                            <p style={{color:'rgb(253,224,71)',fontFamily:'monospace',fontWeight:'bold',fontSize:'54px',margin:0,letterSpacing:'12px'}}>{rc}</p>
                        </div>

                        {ih&&(
                            <div style={{...st.card,marginBottom:'15px'}}>
                                <h3 style={{...st.white,margin:'0 0 12px 0'}}>ğŸ­ Ä°mpostor SayÄ±sÄ±</h3>
                                <div style={{display:'flex',gap:'10px'}}>
                                    {[1,2,3].map(n=>(
                                        <button key={n} onClick={()=>updateImpCount(n)}
                                            style={{flex:1,padding:'15px',borderRadius:'12px',fontSize:'20px',fontWeight:'bold',
                                                border:currentImpCount===n?'3px solid rgb(253,224,71)':'1px solid rgba(255,255,255,0.15)',
                                                background:currentImpCount===n?'rgba(220,38,38,0.5)':'rgba(255,255,255,0.05)',
                                                color:'white',cursor:'pointer'}}>
                                            {n}
                                        </button>
                                    ))}
                                </div>
                                <p style={{color:'rgba(255,255,255,0.3)',fontSize:'11px',margin:'8px 0 0 0',textAlign:'center'}}>
                                    Min. {currentImpCount*2+1} oyuncu gerekli
                                </p>
                            </div>
                        )}
                        {!ih&&rm?.impCount&&(
                            <div style={{...st.card,marginBottom:'15px',textAlign:'center'}}>
                                <p style={{color:'rgba(255,255,255,0.5)',margin:0,fontSize:'14px'}}>
                                    ğŸ­ Bu turda <span style={{color:'rgb(220,38,38)',fontWeight:'bold'}}>{rm.impCount}</span> impostor olacak
                                </p>
                            </div>
                        )}

                        {/* OYUNCULAR */}
                        <div style={{...st.card,marginBottom:'15px'}}>
                            <h3 style={{...st.white,margin:'0 0 12px 0'}}>ğŸ‘¥ Oyuncular ({rm?.players?.length||0}/30)</h3>
                            <div style={{display:'flex',flexDirection:'column',gap:'8px'}}>
                                {rm?.players?.map((p,i)=>(
                                    <div key={i} style={{background:'rgba(255,255,255,0.08)',borderRadius:'10px',padding:'12px 15px',display:'flex',justifyContent:'space-between',alignItems:'center',border:'1px solid rgba(255,255,255,0.05)'}}>
                                        <span style={st.white}>{p.name}{p.name===rm.host?' ğŸ‘‘':''}{p.name===pn?' (Sen)':''}</span>
                                        <div style={{display:'flex',alignItems:'center',gap:'10px'}}>
                                            <span style={st.yellow}>{p.points} pts</span>
                                            {ih&&p.name!==pn&&(
                                                <button onClick={()=>kickPlayer(p.name)}
                                                    style={{background:'rgba(220,38,38,0.4)',border:'1px solid rgba(220,38,38,0.6)',borderRadius:'6px',color:'white',padding:'4px 8px',fontSize:'12px',cursor:'pointer'}}>
                                                    âœ• Ã‡Ä±kar
                                                </button>
                                            )}
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>

                        {/* KATEGORÄ° */}
                        {ih&&(
                            <div style={{...st.card,marginBottom:'15px'}}>
                                <h3 style={{...st.white,margin:'0 0 12px 0'}}>ğŸ“‚ Kategori SeÃ§in</h3>
                                <div style={{display:'grid',gridTemplateColumns:'repeat(2,1fr)',gap:'8px'}}>
                                    {Object.keys(CAT).map(k=>(
                                        <button key={k} onClick={()=>setSc(k)} style={{padding:'12px',borderRadius:'10px',background:sc===k?'linear-gradient(90deg,rgb(34,197,94),rgb(21,128,61))':'rgba(255,255,255,0.08)',border:sc===k?'2px solid white':'1px solid rgba(255,255,255,0.1)',color:'white',fontWeight:'600',cursor:'pointer',fontSize:'13px'}}>
                                            {CAT[k].name}
                                        </button>
                                    ))}
                                </div>
                            </div>
                        )}

                        {/* Ä°MPOSTOR SEÃ‡Ä°MÄ° - TIKLANARAK */}
                        {ih&&sc&&(
                            <div style={{...st.card,marginBottom:'15px'}}>
                                <h3 style={{...st.white,margin:'0 0 8px 0'}}>ğŸ¯ Ä°mpostor SeÃ§in ({selectedImpostors.length}/{currentImpCount})</h3>
                                <p style={{color:'rgba(255,255,255,0.4)',fontSize:'12px',margin:'0 0 12px 0'}}>Listeden {currentImpCount} oyuncu seÃ§in (tÄ±klayarak)</p>
                                <div style={{display:'flex',flexDirection:'column',gap:'8px'}}>
                                    {rm?.players?.map((p,i)=>{
                                        const isSelected=selectedImpostors.includes(p.name);
                                        return(
                                            <button key={i} onClick={()=>toggleImpostor(p.name)}
                                                style={{
                                                    background:isSelected?'rgba(220,38,38,0.5)':'rgba(255,255,255,0.05)',
                                                    border:isSelected?'2px solid rgb(220,38,38)':'1px solid rgba(255,255,255,0.1)',
                                                    borderRadius:'10px',padding:'12px 15px',
                                                    color:'white',fontWeight:'600',cursor:'pointer',
                                                    display:'flex',justifyContent:'space-between',alignItems:'center'
                                                }}>
                                                <span>{p.name}</span>
                                                {isSelected&&<span>ğŸ­ SeÃ§ildi</span>}
                                            </button>
                                        )
                                    })}
                                </div>
                            </div>
                        )}

                        {ih&&sc&&selectedImpostors.length===currentImpCount&&<button onClick={sg}
                            disabled={!rm?.players||rm.players.length<(currentImpCount*2+1)}
                            style={st.btn('linear-gradient(90deg,rgb(34,197,94),rgb(21,128,61))',!rm?.players||rm.players.length<(currentImpCount*2+1))}>
                            ğŸ® Oyunu BaÅŸlat
                        </button>}
                        {ih&&!sc&&<p style={{color:'rgba(255,255,255,0.4)',textAlign:'center',fontSize:'13px'}}>â†‘ Ã–nce bir kategori seÃ§in</p>}
                        {!ih&&<div style={{textAlign:'center',color:'rgba(255,255,255,0.4)',padding:'20px'}} className="pulse">â³ Oda sahibi oyunu baÅŸlatmasÄ± bekleniyor...</div>}
                        <ScorePanel/>
                    </div>
                </div>
            </div>
        )
    }

    if(s==='game'){
        const cms=rm?.players?.filter(p=>p.role==='crewmate')||[];
        const impostors=rm?.players?.filter(p=>p.role==='impostor')||[];
        const gc=cms.filter(p=>p.guess!==null&&p.guess!==undefined).length;
        const orderedPlayers=displayOrder.length>0
            ?displayOrder.map(name=>rm.players.find(p=>p.name===name)).filter(Boolean)
            :rm?.players||[];

        return(
            <div style={st.page}>
                <ScoreTicker/>
                <div style={st.inner}>
                    <div style={{maxWidth:'600px',margin:'0 auto'}}>
                        {/* ROL */}
                        <div style={{...st.card,textAlign:'center',marginBottom:'15px'}}>
                            <p style={{...st.label,marginBottom:'10px'}}>Senin RolÃ¼n</p>
                            <div style={{fontSize:'50px',fontWeight:'900',color:mr==='impostor'?'rgb(220,38,38)':'rgb(96,165,250)',marginBottom:'15px'}}>
                                {mr==='impostor'?'ğŸ­ Ä°MPOSTOR':'âœ… TEMÄ°Z'}
                            </div>
                            {mr==='crewmate'&&rm?.selectedWord&&(
                                <div>
                                    <p style={st.label}>Kategori Kelimesi</p>
                                    <div style={{background:'rgba(96,165,250,0.15)',border:'2px solid rgb(96,165,250)',borderRadius:'12px',padding:'15px',marginBottom:'8px'}}>
                                        <p style={{color:'rgb(253,224,71)',fontWeight:'bold',fontSize:'34px',margin:0}}>{rm.selectedWord}</p>
                                    </div>
                                    <p style={{color:'rgba(255,255,255,0.3)',fontSize:'11px',margin:0}}>Ä°mpostor bu kelimeyi bilmiyor!</p>
                                </div>
                            )}
                            {mr==='impostor'&&(
                                <div>
                                    <div style={{background:'rgba(220,38,38,0.1)',border:'2px solid rgba(220,38,38,0.3)',borderRadius:'12px',padding:'15px',marginBottom:'10px'}}>
                                        <p style={{color:'rgba(255,255,255,0.6)',fontSize:'14px',margin:'0 0 4px 0'}}>âš ï¸ Kategori kelimesini bilmiyorsun!</p>
                                        <p style={{color:'rgba(255,255,255,0.3)',fontSize:'12px',margin:0}}>DiÄŸerleri tartÄ±ÅŸÄ±rken yakalanma!</p>
                                    </div>
                                    {impostors.length>1&&(
                                        <div style={{background:'rgba(220,38,38,0.08)',borderRadius:'10px',padding:'10px',border:'1px solid rgba(220,38,38,0.2)'}}>
                                            <p style={{color:'rgba(255,255,255,0.5)',fontSize:'12px',margin:'0 0 6px 0'}}>DiÄŸer impostorlar:</p>
                                            <div style={{display:'flex',flexWrap:'wrap',gap:'6px',justifyContent:'center'}}>
                                                {impostors.filter(imp=>imp.name!==pn).map((imp,i)=>(
                                                    <span key={i} style={{background:'rgba(220,38,38,0.3)',padding:'4px 10px',borderRadius:'8px',color:'white',fontSize:'13px',fontWeight:'bold'}}>ğŸ­ {imp.name}</span>
                                                ))}
                                            </div>
                                        </div>
                                    )}
                                </div>
                            )}
                        </div>

                        {/* TEMÄ°Z â†’ SEÃ‡ME */}
                        {mr==='crewmate'&&(
                            <div style={{...st.card,marginBottom:'15px'}}>
                                <h3 style={{...st.white,margin:'0 0 12px 0'}}>ğŸ” Ä°mpostoru SeÃ§</h3>
                                {!hg?(
                                    <div style={{display:'flex',flexDirection:'column',gap:'8px'}}>
                                        {orderedPlayers.map((p,i)=>{
                                            const isSelected=selectedImpostors.includes(p.name);
                                            return(
                                                <button key={i} onClick={()=>setSelectedImpostors([p.name])}
                                                    style={{
                                                        background:isSelected?'rgba(168,85,247,0.4)':'rgba(255,255,255,0.05)',
                                                        border:isSelected?'2px solid rgb(168,85,247)':'1px solid rgba(255,255,255,0.1)',
                                                        borderRadius:'10px',padding:'12px 15px',
                                                        color:'white',fontWeight:'600',cursor:'pointer',
                                                        display:'flex',justifyContent:'space-between',alignItems:'center'
                                                    }}>
                                                    <span>{p.name}</span>
                                                    {isSelected&&<span>âœ“ SeÃ§ildi</span>}
                                                </button>
                                            )
                                        })}
                                        <button onClick={sub} disabled={!selectedImpostors[0]} style={st.btn('linear-gradient(90deg,rgb(168,85,247),rgb(147,51,234))',!selectedImpostors[0])}>âœ‰ï¸ Tahmini GÃ¶nder</button>
                                    </div>
                                ):(
                                    <div style={{background:'rgba(34,197,94,0.1)',border:'2px solid rgba(34,197,94,0.3)',borderRadius:'10px',padding:'15px',textAlign:'center'}}>
                                        <p style={{color:'rgb(134,239,172)',fontWeight:'600',fontSize:'16px',margin:'0 0 6px 0'}}>âœ“ Tahmininiz gÃ¶nderildi!</p>
                                        <p style={{color:'rgba(255,255,255,0.6)',margin:0}}>"{selectedImpostors[0]}"</p>
                                        <p style={{color:'rgba(255,255,255,0.3)',fontSize:'12px',margin:'8px 0 0 0'}} className="pulse">â³ DiÄŸerleri bekleniyor... ({gc}/{cms.length})</p>
                                    </div>
                                )}
                            </div>
                        )}

                        {mr==='impostor'&&(
                            <div style={{...st.card,marginBottom:'15px',textAlign:'center'}}>
                                <p style={{color:'rgba(255,255,255,0.5)',margin:0}} className="pulse">â³ OyuncularÄ±n tahmin etmesi bekleniyor... ({gc}/{cms.length})</p>
                            </div>
                        )}

                        {/* OYUNCU LÄ°STESÄ° */}
                        <div style={st.card}>
                            <h3 style={{...st.white,margin:'0 0 5px 0'}}>ğŸ‘¥ Oyuncular</h3>
                            <p style={{color:'rgba(255,255,255,0.3)',fontSize:'12px',margin:'0 0 12px 0'}}>{gc}/{cms.length} kiÅŸi tahminini gÃ¶nderdi</p>
                            <div style={{display:'flex',flexDirection:'column',gap:'8px'}}>
                                {orderedPlayers.map((p,i)=>{
                                    const isMe=p.name===pn;
                                    const showMyStatus=isMe&&p.role==='crewmate';
                                    return(
                                        <div key={i} style={{
                                            background:isMe?'rgba(255,255,255,0.12)':'rgba(255,255,255,0.05)',
                                            borderRadius:'10px',padding:'12px 15px',
                                            display:'flex',alignItems:'center',justifyContent:'space-between',
                                            border:isMe?'1px solid rgba(255,255,255,0.2)':'1px solid rgba(255,255,255,0.05)'
                                        }}>
                                            <span style={{color:'white',fontWeight:'600'}}>{p.name}{isMe?' (Sen)':''}</span>
                                            {showMyStatus&&(
                                                hg
                                                    ?<span style={{fontSize:'12px',color:'rgb(74,222,128)'}}>âœ“ GÃ¶nderildi</span>
                                                    :<span style={{fontSize:'12px',color:'rgb(250,204,21)'}} className="pulse">â³ SeÃ§</span>
                                            )}
                                        </div>
                                    )
                                })}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        )
    }

    if(s==='results'){
        const impostors=rm?.players?.filter(p=>p.role==='impostor')||[];
        const sp=[...(rm?.players||[])].sort((a,b)=>b.points-a.points);
        const solo=(rm?.correctGuessers?.length===1);
        return(
            <div style={st.page}>
                <ScoreTicker/>
                <div style={st.inner}>
                    <div style={{maxWidth:'700px',margin:'0 auto'}}>
                        <div style={{...st.card,textAlign:'center',marginBottom:'15px'}}>
                            <h2 style={{fontSize:'28px',fontWeight:'bold',color:'white',margin:'0 0 12px 0'}}>ğŸ† SonuÃ§lar</h2>
                            <div style={{fontSize:'34px',fontWeight:'900',color:rm?.winner==='impostor'?'rgb(220,38,38)':'rgb(74,222,128)',marginBottom:'15px'}}>
                                {rm?.winner==='impostor'?'Ä°mpostor KazandÄ±! ğŸ­':'Temizler KazandÄ±! â­'}
                            </div>
                            {rm?.selectedWord&&(
                                <div style={{marginBottom:'15px'}}>
                                    <p style={st.label}>Kelime</p>
                                    <p style={{...st.yellow,fontSize:'30px',margin:0}}>{rm.selectedWord}</p>
                                </div>
                            )}
                            <div style={{background:'rgba(255,255,255,0.08)',borderRadius:'12px',padding:'15px',display:'inline-block',border:'1px solid rgba(255,255,255,0.1)'}}>
                                <p style={{color:'rgba(255,255,255,0.6)',margin:'0 0 8px 0',fontSize:'13px'}}>Ä°mpostor{impostors.length>1?'lar':''}:</p>
                                <div style={{display:'flex',gap:'8px',flexWrap:'wrap',justifyContent:'center'}}>
                                    {impostors.map((imp,i)=>(
                                        <span key={i} style={{background:'rgb(220,38,38)',padding:'8px 20px',borderRadius:'20px',color:'white',fontWeight:'bold',fontSize:'16px'}}>ğŸ­ {imp.name}</span>
                                    ))}
                                </div>
                            </div>
                        </div>

                        {rm?.correctGuessers&&rm.correctGuessers.length>0&&(
                            <div style={{background:'rgba(34,197,94,0.1)',border:'2px solid rgba(34,197,94,0.3)',borderRadius:'15px',padding:'18px',marginBottom:'15px'}}>
                                <h3 style={{color:'rgb(134,239,172)',margin:'0 0 10px 0',fontSize:'16px'}}>
                                    ğŸ¯ {solo?'Tek baÅŸÄ±na buldu! (+5 puan)':'DoÄŸru tahmin (+2 puan):'}
                                </h3>
                                <div style={{display:'flex',flexWrap:'wrap',gap:'8px'}}>
                                    {rm.correctGuessers.map((n,i)=>(
                                        <span key={i} style={{background:'rgba(34,197,94,0.25)',padding:'6px 14px',borderRadius:'8px',color:'white',fontWeight:'600',fontSize:'14px'}}>âœ“ {n} {solo?'(+5)':'(+2)'}</span>
                                    ))}
                                </div>
                            </div>
                        )}

                        {rm?.wrongGuessers&&rm.wrongGuessers.length>0&&(
                            <div style={{background:'rgba(220,38,38,0.08)',border:'2px solid rgba(220,38,38,0.2)',borderRadius:'15px',padding:'18px',marginBottom:'15px'}}>
                                <h3 style={{color:'rgb(252,165,165)',margin:'0 0 10px 0',fontSize:'16px'}}>âŒ YanlÄ±ÅŸ tahmin (-2 puan):</h3>
                                <div style={{display:'flex',flexWrap:'wrap',gap:'8px'}}>
                                    {rm.wrongGuessers.map((n,i)=>(
                                        <span key={i} style={{background:'rgba(220,38,38,0.18)',padding:'6px 14px',borderRadius:'8px',color:'white',fontWeight:'600',fontSize:'14px'}}>âœ— {n} (-2)</span>
                                    ))}
                                </div>
                            </div>
                        )}

                        <div style={{...st.card,marginBottom:'15px'}}>
                            <h3 style={{...st.white,margin:'0 0 12px 0',fontSize:'20px'}}>ğŸ… Skor Tablosu</h3>
                            <div style={{display:'flex',flexDirection:'column',gap:'8px'}}>
                                {sp.map((p,i)=>(
                                    <div key={i} style={{borderRadius:'10px',padding:'14px 18px',display:'flex',alignItems:'center',justifyContent:'space-between',background:i===0?'rgba(234,179,8,0.2)':i===1?'rgba(156,163,175,0.15)':i===2?'rgba(249,115,22,0.15)':'rgba(255,255,255,0.05)',border:i===0?'2px solid rgb(234,179,8)':i===1?'1px solid rgba(156,163,175,0.4)':i===2?'1px solid rgba(249,115,22,0.4)':'1px solid rgba(255,255,255,0.05)'}}>
                                        <div style={{display:'flex',alignItems:'center',gap:'12px'}}>
                                            <span style={{fontSize:'20px'}}>{i===0?'ğŸ¥‡':i===1?'ğŸ¥ˆ':i===2?'ğŸ¥‰':`#${i+1}`}</span>
                                            <span style={{color:'white',fontWeight:'bold'}}>{p.name}{p.name===pn?' (Sen)':''}</span>
                                            {p.role==='impostor'&&<span style={{background:'rgba(220,38,38,0.4)',padding:'2px 8px',borderRadius:'8px',color:'white',fontSize:'11px'}}>ğŸ­ Ä°mpostor</span>}
                                        </div>
                                        <span style={{fontSize:'20px',fontWeight:'bold',color:'rgb(253,224,71)'}}>{p.points}</span>
                                    </div>
                                ))}
                            </div>
                        </div>

                        {ih?(
                            <button onClick={nr} style={st.btn('linear-gradient(90deg,rgb(37,99,235),rgb(29,78,216))',false)}>
                                ğŸ”„ Yeni Tur BaÅŸlat
                            </button>
                        ):(
                            <div style={{...st.card,textAlign:'center'}}>
                                <p style={{color:'rgba(255,255,255,0.5)',margin:0}} className="pulse">â³ Oda sahibinin yeni tur baÅŸlatmasÄ± bekleniyor...</p>
                            </div>
                        )}
                    </div>
                </div>
            </div>
        )
    }
    return null;
}
ReactDOM.render(React.createElement(App),document.getElementById('root'));
</script></body></html>
